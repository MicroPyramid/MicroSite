{% extends 'site/blog/base.html' %}

{% block blogcontent %}



      
      <!-- sec-about starts -->
      <div class="col-sm-12 col-md-9 blog-container-left">
            <div class="isotope clearfix">

            {% for post in posts %}
              <div class="col-lg-4 col-sm-4 col-md-4  col-sm-4  item blog-m-block" data-effect="fade">
                <div class="blog-columns {% cycle blog-yellow,blog-green,blog-blue %}">
                  <div class="media_element">

                    {% if post.featured_image %}
                        <img src="/static/blog/{{post.featured_image}}" class="img-responsive blog-image" alt="">
                                            
                    {% endif %}                     
                  </div>
                  <!-- media_element -->
                  <div class="blog-content" >
                    <div class="blog-content-left" style="display:table-cell;">
                      <div class="title">
                        <h3><a href="/blog/{{post.slug}}/" title="{{post.title}}">{{post.title}}</a></h3>
                      </div>
                      <!-- end title -->
                      <p>{{post.content|safe|truncatewords:100}}</p>
                      <div class="post_meta">
                        <span><i class="fa fa-calendar"></i> {{post.created_on|date:"d M  y"}}</span>
                        <span>
                          {% for tag in post.tags.all %}
                            <i class="fa fa-tag"></i> <a href="/blog/tag/{{tag.slug}}/">{{tag.name}}</a>
                          {% endfor %}
                        </span>
                        <span><i class="fa fa-comment"></i> <a href="#">{{post.get_comment_count}} Comments</a></span>
                      </div>
                      <!-- end post-meta -->
                      <div class="name-read">
                        <a href="#"><i class="fa fa-user"></i>{{post.author}}</a> <span><a href="/blog/{{post.slug}}/"><i class="fa fa-book"></i> Readmore</a></span>
                      </div>
                    </div>
                    <div class="blog-content-social">
                      <ul>
                        <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                        <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                        <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                        <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                   </ul>
                      
                    </div>
                    <br clear="all">
                  </div>
                  <!-- end blog-content -->
                </div>
                <!-- blog-columns -->
              </div>
              
              {% endfor %}
            </div>
            <div class="row marl paging">
              <div class="col-xs-12 ">
                <div class="pagination-box">
                  <ul class="pagination">
                    <!-- <li class="disabled"><a href="#"><i class="fa fa-angle-left"></i> Prev</a></li> -->
                    {% for s in pages %}
                     <li {% ifequal s current_page %} class="active" {% endifequal %}><a href="/blog/?page={{s}}">{{s}}</a>
                     </li>
                    
                    <li class="disabled"><a href="/blog/?page={{s}}">...</a></li>
                    <li><a href="/blog/?page={{last_page}}">last</a></li>
                    <li><a href="/blog/?page={{s}}">Next<i class="fa fa-angle-right pagination-next"></i></a>
                    </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
          </div>
      <!-- sec-about ends -->

<script>

var arr = [];

window.fbAsyncInit = function() {
    FB.init({
      appId      : '464918096908788', // App ID
      channelUrl : '//www.micropyramid.com/', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    function updateButton(response) {
        
        if (response.authResponse) {
            FB.api('/me', function(info) {
                login(response, info);
            });
            
            $('a#flogout').click(function(e){
              e.preventDefault();
                FB.logout(function(response) {
          //clear user info
          userlogin=false;
          $.post('/logout/',{},function(){
            location.reload();  
          });
          
                });
            });
        } else {
            //user is not connected to app or logged out
            userlogin=false;
          $('#sp-uinfo').hide();
          $('#sp-flgn').show();
            $('a.faceBtn').click(function(e) {
              e.preventDefault();
                FB.login(function(response) {
                    if (response.authResponse) {
                        FB.api('/me', function(info) {
                            login(response, info);
                        });
                        FB.api('/me/friends', {fields:'name,first_name,gender'}, function(response) {
                          return; 
                        });
                        
                        
                    } else {
                        //user cancelled login or did not grant authorization
                    }
                }, {scope:'offline_access,email,user_about_me,user_location, publish_actions'});    
            });
        }
    }
    
    // run once with current status and whenever the status changes
    FB.getLoginStatus(updateButton);
    FB.Event.subscribe('auth.statusChange', updateButton);
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));

  
  function login(response, info)
  {
    if (response.authResponse) {
      $.post('/fblogin/',{},function(d){
        
      });
      
      $('#uimg').attr('src','//graph.facebook.com/' + info.id + '/picture?width=30&height=30');
      $('#uname').html(info.first_name);
      userlogin=true;
      $('#sp-uinfo').show();
      $('#sp-flgn').hide();
      
    }
  }
  
  function invite_friends(){
    FB.ui({
    method: 'apprequests',
    message: 'Try Study Signal'
    });
  } 
  
  function send_requests(arr){
    FB.ui({
      method: 'apprequests',
      message: 'Try StudySignal!!!',
      to:arr.join(',')
    });
    } 

</script>


{% endblock %}      